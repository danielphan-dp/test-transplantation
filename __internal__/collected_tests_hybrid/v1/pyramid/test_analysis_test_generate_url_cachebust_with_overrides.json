{
  "test_name": "test_generate_url_cachebust_with_overrides",
  "test_file": "/home/quark-ubuntu-wsl/test_transplantation_cs846_f24/test-transplantation/__internal__/_data/pyramid/tests/test_config/test_views.py",
  "static_methods": [
    {
      "name": "testing.setUp",
      "source_code": "    def setUp(self):\n        # sanity check\n        self.assertNotWrapped()",
      "file_path": "/home/quark-ubuntu-wsl/test_transplantation_cs846_f24/test-transplantation/__internal__/_data/pyramid/venv/lib/python3.9/site-packages/pip/_vendor/colorama/tests/initialise_test.py",
      "line_number": 21
    },
    {
      "name": "testing.DummyRequest",
      "source_code": "",
      "file_path": "",
      "line_number": 0
    },
    {
      "name": "config.add_static_view",
      "source_code": "    def add_static_view(self, name, path, **kw):\n        \"\"\"Add a view used to render static assets such as images\n        and CSS files.",
      "file_path": "/home/quark-ubuntu-wsl/test_transplantation_cs846_f24/test-transplantation/__internal__/_data/pyramid/src/pyramid/config/views.py",
      "line_number": 1940
    },
    {
      "name": "config.override_asset",
      "source_code": "    def override_asset(self, to_override, override_with, _override=None):\n        \"\"\"Add a :app:`Pyramid` asset override to the current\n        configuration state.",
      "file_path": "/home/quark-ubuntu-wsl/test_transplantation_cs846_f24/test-transplantation/__internal__/_data/pyramid/src/pyramid/config/assets.py",
      "line_number": 319
    },
    {
      "name": "config.add_cache_buster",
      "source_code": "    def add_cache_buster(config, spec, cache_buster):\n        \"\"\"Add a new cache buster to a particular set of assets\"\"\"",
      "file_path": "/home/quark-ubuntu-wsl/test_transplantation_cs846_f24/test-transplantation/__internal__/_data/pyramid/src/pyramid/interfaces.py",
      "line_number": 719
    },
    {
      "name": "request.static_url",
      "source_code": "def static_url(path, request, **kw):\n    \"\"\"\n    This is a backwards compatibility function.  Its result is the same as\n    calling::",
      "file_path": "/home/quark-ubuntu-wsl/test_transplantation_cs846_f24/test-transplantation/__internal__/_data/pyramid/src/pyramid/url.py",
      "line_number": 822
    },
    {
      "name": "self.assertEqual",
      "source_code": "",
      "file_path": "",
      "line_number": 0
    },
    {
      "name": "config.add_cache_buster",
      "source_code": "    def add_cache_buster(config, spec, cache_buster):\n        \"\"\"Add a new cache buster to a particular set of assets\"\"\"",
      "file_path": "/home/quark-ubuntu-wsl/test_transplantation_cs846_f24/test-transplantation/__internal__/_data/pyramid/src/pyramid/interfaces.py",
      "line_number": 719
    },
    {
      "name": "request.static_url",
      "source_code": "def static_url(path, request, **kw):\n    \"\"\"\n    This is a backwards compatibility function.  Its result is the same as\n    calling::",
      "file_path": "/home/quark-ubuntu-wsl/test_transplantation_cs846_f24/test-transplantation/__internal__/_data/pyramid/src/pyramid/url.py",
      "line_number": 822
    },
    {
      "name": "self.assertEqual",
      "source_code": "",
      "file_path": "",
      "line_number": 0
    },
    {
      "name": "testing.tearDown",
      "source_code": "    def tearDown(self):\n        _wipe_internal_state_for_tests()\n        sys.stdout = orig_stdout\n        sys.stderr = orig_stderr",
      "file_path": "/home/quark-ubuntu-wsl/test_transplantation_cs846_f24/test-transplantation/__internal__/_data/pyramid/venv/lib/python3.9/site-packages/pip/_vendor/colorama/tests/initialise_test.py",
      "line_number": 25
    },
    {
      "name": "cb",
      "source_code": "            def cb(val):\n                def cb_(request, subpath, kw):\n                    kw['_query'] = {'x': val}\n                    return subpath, kw",
      "file_path": "/home/quark-ubuntu-wsl/test_transplantation_cs846_f24/test-transplantation/__internal__/_data/pyramid/tests/test_config/test_views.py",
      "line_number": 4073
    },
    {
      "name": "cb",
      "source_code": "            def cb(val):\n                def cb_(request, subpath, kw):\n                    kw['_query'] = {'x': val}\n                    return subpath, kw",
      "file_path": "/home/quark-ubuntu-wsl/test_transplantation_cs846_f24/test-transplantation/__internal__/_data/pyramid/tests/test_config/test_views.py",
      "line_number": 4073
    }
  ],
  "dynamic_methods": [
    {
      "function": "testing.setUp",
      "filename": "/home/quark-ubuntu-wsl/test_transplantation_cs846_f24/test-transplantation/__internal__/_data/pyramid/venv/lib/python3.9/site-packages/pip/_vendor/colorama/tests/initialise_test.py",
      "line": 21,
      "caller": "test_generate_url_cachebust_with_overrides",
      "source_code": "    @skipUnless(sys.stdout.isatty(), \"sys.stdout is not a tty\")\n    def setUp(self):\n        # sanity check\n        self.assertNotWrapped()\n\n"
    },
    {
      "function": "testing.DummyRequest",
      "filename": "",
      "line": 0,
      "caller": "test_generate_url_cachebust_with_overrides",
      "source_code": ""
    },
    {
      "function": "config.add_static_view",
      "filename": "/home/quark-ubuntu-wsl/test_transplantation_cs846_f24/test-transplantation/__internal__/_data/pyramid/src/pyramid/config/views.py",
      "line": 1940,
      "caller": "test_generate_url_cachebust_with_overrides",
      "source_code": "    @action_method\n    def add_static_view(self, name, path, **kw):\n        \"\"\"Add a view used to render static assets such as images\n        and CSS files.\n\n        The ``name`` argument is a string representing an\n        application-relative local URL prefix.  It may alternately be a full\n        URL.\n\n        The ``path`` argument is the path on disk where the static files\n        reside.  This can be an absolute path, a package-relative path, or a\n        :term:`asset specification`.\n\n        The ``cache_max_age`` keyword argument is input to set the\n        ``Expires`` and ``Cache-Control`` headers for static assets served.\n        Note that this argument has no effect when the ``name`` is a *url\n        prefix*.  By default, this argument is ``None``, meaning that no\n        particular Expires or Cache-Control headers are set in the response.\n\n        The ``content_encodings`` keyword argument is a list of alternative\n        file encodings supported in the ``Accept-Encoding`` HTTP Header.\n        Alternative files are found using file extensions defined in\n        :attr:`mimetypes.encodings_map`. An encoded asset will be returned\n        with the ``Content-Encoding`` header set to the selected encoding.\n        If the asset contains alternative encodings then the\n        ``Accept-Encoding`` value will be added to the response's ``Vary``\n        header. By default, the list is empty and no alternatives will be\n        supported.\n\n        The ``permission`` keyword argument is used to specify the\n        :term:`permission` required by a user to execute the static view.  By\n        default, it is the string\n        :data:`pyramid.security.NO_PERMISSION_REQUIRED`, a special sentinel\n        which indicates that, even if a :term:`default permission` exists for\n        the current application, the static view should be renderered to\n        completely anonymous users.  This default value is permissive\n        because, in most web apps, static assets seldom need protection from\n        viewing.  If ``permission`` is specified, the security checking will\n        be performed against the default root factory ACL.\n\n        Any other keyword arguments sent to ``add_static_view`` are passed on\n        to :meth:`pyramid.config.Configurator.add_route` (e.g. ``factory``,\n        perhaps to define a custom factory with a custom ACL for this static\n        view).\n\n        *Usage*\n\n        The ``add_static_view`` function is typically used in conjunction\n        with the :meth:`pyramid.request.Request.static_url` method.\n        ``add_static_view`` adds a view which renders a static asset when\n        some URL is visited; :meth:`pyramid.request.Request.static_url`\n        generates a URL to that asset.\n\n        The ``name`` argument to ``add_static_view`` is usually a simple URL\n        prefix (e.g. ``'images'``).  When this is the case, the\n        :meth:`pyramid.request.Request.static_url` API will generate a URL\n        which points to a Pyramid view, which will serve up a set of assets\n        that live in the package itself. For example:\n\n        .. code-block:: python\n\n           add_static_view('images', 'mypackage:images/')\n\n        Code that registers such a view can generate URLs to the view via\n        :meth:`pyramid.request.Request.static_url`:\n\n        .. code-block:: python\n\n           request.static_url('mypackage:images/logo.png')\n\n        When ``add_static_view`` is called with a ``name`` argument that\n        represents a URL prefix, as it is above, subsequent calls to\n        :meth:`pyramid.request.Request.static_url` with paths that start with\n        the ``path`` argument passed to ``add_static_view`` will generate a\n        URL something like ``http://<Pyramid app URL>/images/logo.png``,\n        which will cause the ``logo.png`` file in the ``images`` subdirectory\n        of the ``mypackage`` package to be served.\n\n        ``add_static_view`` can alternately be used with a ``name`` argument\n        which is a *URL*, causing static assets to be served from an external\n        webserver.  This happens when the ``name`` argument is a fully\n        qualified URL (e.g. starts with ``http://`` or similar).  In this\n        mode, the ``name`` is used as the prefix of the full URL when\n        generating a URL using :meth:`pyramid.request.Request.static_url`.\n        Furthermore, if a protocol-relative URL (e.g. ``//example.com/images``)\n        is used as the ``name`` argument, the generated URL will use the\n        protocol of the request (http or https, respectively).\n\n        For example, if ``add_static_view`` is called like so:\n\n        .. code-block:: python\n\n           add_static_view('http://example.com/images', 'mypackage:images/')\n\n        Subsequently, the URLs generated by\n        :meth:`pyramid.request.Request.static_url` for that static view will\n        be prefixed with ``http://example.com/images`` (the external webserver\n        listening on ``example.com`` must be itself configured to respond\n        properly to such a request.):\n\n        .. code-block:: python\n\n           static_url('mypackage:images/logo.png', request)\n\n        See :ref:`static_assets_section` for more information.\n\n        .. versionchanged:: 2.0\n\n           Added the ``content_encodings`` argument.\n\n        \"\"\"\n        spec = self._make_spec(path)\n        info = self._get_static_info()\n        info.add(self, name, spec, **kw)\n\n"
    },
    {
      "function": "config.override_asset",
      "filename": "/home/quark-ubuntu-wsl/test_transplantation_cs846_f24/test-transplantation/__internal__/_data/pyramid/src/pyramid/config/assets.py",
      "line": 319,
      "caller": "test_generate_url_cachebust_with_overrides",
      "source_code": "    @action_method\n    def override_asset(self, to_override, override_with, _override=None):\n        \"\"\"Add a :app:`Pyramid` asset override to the current\n        configuration state.\n\n        ``to_override`` is an :term:`asset specification` to the\n        asset being overridden.\n\n        ``override_with`` is an :term:`asset specification` to the\n        asset that is performing the override. This may also be an absolute\n        path.\n\n        See :ref:`assets_chapter` for more\n        information about asset overrides.\"\"\"\n        if to_override == override_with:\n            raise ConfigurationError(\n                'You cannot override an asset with itself'\n            )\n\n        package = to_override\n        path = ''\n        if ':' in to_override:\n            package, path = to_override.split(':', 1)\n\n        # *_isdir = override is package or directory\n        overridden_isdir = path == '' or path.endswith('/')\n\n        if os.path.isabs(override_with):\n            override_source = FSAssetSource(override_with)\n            if not os.path.exists(override_with):\n                raise ConfigurationError(\n                    'Cannot override asset with an absolute path that does '\n                    'not exist'\n                )\n            override_isdir = os.path.isdir(override_with)\n            override_package = None\n            override_prefix = override_with\n        else:\n            override_package = override_with\n            override_prefix = ''\n            if ':' in override_with:\n                override_package, override_prefix = override_with.split(':', 1)\n\n            __import__(override_package)\n            to_package = sys.modules[override_package]\n            override_source = PackageAssetSource(to_package, override_prefix)\n\n            override_isdir = override_prefix == '' or override_with.endswith(\n                '/'\n            )\n\n        if overridden_isdir and (not override_isdir):\n            raise ConfigurationError(\n                'A directory cannot be overridden with a file (put a '\n                'slash at the end of override_with if necessary)'\n            )\n\n        if (not overridden_isdir) and override_isdir:\n            raise ConfigurationError(\n                'A file cannot be overridden with a directory (put a '\n                'slash at the end of to_override if necessary)'\n            )\n\n        override = _override or self._override  # test jig\n\n        def register():\n            __import__(package)\n            from_package = sys.modules[package]\n            override(from_package, path, override_source)\n\n        intr = self.introspectable(\n            'asset overrides',\n            (package, override_package, path, override_prefix),\n            f'{to_override} -> {override_with}',\n            'asset override',\n        )\n        intr['to_override'] = to_override\n        intr['override_with'] = override_with\n        self.action(\n            None, register, introspectables=(intr,), order=PHASE1_CONFIG\n        )\n\n"
    },
    {
      "function": "config.add_cache_buster",
      "filename": "/home/quark-ubuntu-wsl/test_transplantation_cs846_f24/test-transplantation/__internal__/_data/pyramid/src/pyramid/interfaces.py",
      "line": 719,
      "caller": "test_generate_url_cachebust_with_overrides",
      "source_code": "    def add_cache_buster(config, spec, cache_buster):\n        \"\"\"Add a new cache buster to a particular set of assets\"\"\"\n\n\n"
    },
    {
      "function": "request.static_url",
      "filename": "/home/quark-ubuntu-wsl/test_transplantation_cs846_f24/test-transplantation/__internal__/_data/pyramid/src/pyramid/url.py",
      "line": 822,
      "caller": "test_generate_url_cachebust_with_overrides",
      "source_code": "def static_url(path, request, **kw):\n    \"\"\"\n    This is a backwards compatibility function.  Its result is the same as\n    calling::\n\n        request.static_url(path, **kw)\n\n    See :meth:`pyramid.request.Request.static_url` for more information.\n    \"\"\"\n    if not os.path.isabs(path):\n        if ':' not in path:\n            # if it's not a package:relative/name and it's not an\n            # /absolute/path it's a relative/path; this means its relative\n            # to the package in which the caller's module is defined.\n            package = caller_package()\n            path = f'{package.__name__}:{path}'\n    return request.static_url(path, **kw)\n\n\n"
    },
    {
      "function": "self.assertEqual",
      "filename": "",
      "line": 0,
      "caller": "test_generate_url_cachebust_with_overrides",
      "source_code": ""
    },
    {
      "function": "config.add_cache_buster",
      "filename": "/home/quark-ubuntu-wsl/test_transplantation_cs846_f24/test-transplantation/__internal__/_data/pyramid/src/pyramid/interfaces.py",
      "line": 719,
      "caller": "test_generate_url_cachebust_with_overrides",
      "source_code": "    def add_cache_buster(config, spec, cache_buster):\n        \"\"\"Add a new cache buster to a particular set of assets\"\"\"\n\n\n"
    },
    {
      "function": "request.static_url",
      "filename": "/home/quark-ubuntu-wsl/test_transplantation_cs846_f24/test-transplantation/__internal__/_data/pyramid/src/pyramid/url.py",
      "line": 822,
      "caller": "test_generate_url_cachebust_with_overrides",
      "source_code": "def static_url(path, request, **kw):\n    \"\"\"\n    This is a backwards compatibility function.  Its result is the same as\n    calling::\n\n        request.static_url(path, **kw)\n\n    See :meth:`pyramid.request.Request.static_url` for more information.\n    \"\"\"\n    if not os.path.isabs(path):\n        if ':' not in path:\n            # if it's not a package:relative/name and it's not an\n            # /absolute/path it's a relative/path; this means its relative\n            # to the package in which the caller's module is defined.\n            package = caller_package()\n            path = f'{package.__name__}:{path}'\n    return request.static_url(path, **kw)\n\n\n"
    },
    {
      "function": "self.assertEqual",
      "filename": "",
      "line": 0,
      "caller": "test_generate_url_cachebust_with_overrides",
      "source_code": ""
    },
    {
      "function": "testing.tearDown",
      "filename": "/home/quark-ubuntu-wsl/test_transplantation_cs846_f24/test-transplantation/__internal__/_data/pyramid/venv/lib/python3.9/site-packages/pip/_vendor/colorama/tests/initialise_test.py",
      "line": 25,
      "caller": "test_generate_url_cachebust_with_overrides",
      "source_code": "    def tearDown(self):\n        _wipe_internal_state_for_tests()\n        sys.stdout = orig_stdout\n        sys.stderr = orig_stderr\n\n"
    },
    {
      "function": "cb",
      "filename": "/home/quark-ubuntu-wsl/test_transplantation_cs846_f24/test-transplantation/__internal__/_data/pyramid/tests/test_config/test_views.py",
      "line": 4073,
      "caller": "test_generate_url_cachebust_with_overrides",
      "source_code": "            def cb(val):\n                def cb_(request, subpath, kw):\n                    kw['_query'] = {'x': val}\n                    return subpath, kw\n\n                return cb_\n\n"
    },
    {
      "function": "cb",
      "filename": "/home/quark-ubuntu-wsl/test_transplantation_cs846_f24/test-transplantation/__internal__/_data/pyramid/tests/test_config/test_views.py",
      "line": 4073,
      "caller": "test_generate_url_cachebust_with_overrides",
      "source_code": "            def cb(val):\n                def cb_(request, subpath, kw):\n                    kw['_query'] = {'x': val}\n                    return subpath, kw\n\n                return cb_\n\n"
    }
  ],
  "assertions": [],
  "mocks": [],
  "success": false,
  "test_source_code": "def test_generate_url_cachebust_with_overrides(self):\n        config = testing.setUp()\n        try:\n            request = testing.DummyRequest()\n            config.add_static_view('static', 'path')\n            config.override_asset(\n                'tests.test_config:path/', 'tests.test_config:other_path/'\n            )\n\n            def cb(val):\n                def cb_(request, subpath, kw):\n                    kw['_query'] = {'x': val}\n                    return subpath, kw\n\n                return cb_\n\n            config.add_cache_buster('path', cb('foo'))\n            result = request.static_url('path/foo.png')\n            self.assertEqual(result, 'http://example.com/static/foo.png?x=foo')\n            config.add_cache_buster('other_path', cb('bar'), explicit=True)\n            result = request.static_url('path/foo.png')\n            self.assertEqual(result, 'http://example.com/static/foo.png?x=bar')\n        finally:\n            testing.tearDown()"
}